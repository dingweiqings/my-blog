---
title: 线性同余
date: 2022-11-22 10:12:32
tags: 随机数
categories: 算法
---
# 随机数算法
生成真正随机数是比较难的，下面介绍一种常用的伪随机数算法
![lcg](/img/lcg.png)
![lcg-周期](/img/lcg-周期.png)
![lcg-证明](/img/lcg-条件.png)
# code实现
java中java.util.Random类的实现中，发生器的关键代码如下：
```java
private static final long multiplier = 0x5DEECE66DL;
    private static final long addend = 0xBL;
    private static final long mask = (1L << 48) - 1;


    protected int next(int bits) {
        long oldseed, nextseed;
        AtomicLong seed = this.seed;
        do {
            oldseed = seed.get();
            nextseed = (oldseed * multiplier + addend) & mask;
        } while (!seed.compareAndSet(oldseed, nextseed));
        return (int)(nextseed >>> (48 - bits));//丢弃低比特位，保留高比特位
    }

    public int nextInt() {
        return next(32);
    }
```
同时可以看到，上面实现中特意对比特位进行了截取，丢弃低比特位，保留高比特位。
# 数学原理

# 引用
1. [随机数课件](https://www.icst.pku.edu.cn/zlian/docs/20181023161643742238.pdf)
2. [线性同余周期取到n的充分必要条件的证明](https://books.google.com.sg/books?hl=zh-CN&lr=&id=Zu-HAwAAQBAJ&oi=fnd&pg=PT17&ots=9ojjXoVxe_&sig=BqdI06kVqktyfMnAGL8MpvvQyns&redir_esc=y#v=onepage&q&f=false)
3. [线性同于周期取到n的充分必要条件的证明中文版](/file/混合线性同余发生器的周期分析.pdf)
4. [线性同余随机数](https://www.cnblogs.com/qcblog/p/8450427.html)